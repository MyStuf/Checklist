<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <script type="text/javascript" src="jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="NumberOnly.js"></script>
    <style type="text/css"> @import "css/style.css"; </style>
    <script type="text/javascript" src="tests/Data_list.js"> </script>
    <script type="text/javascript" src="tests/Data_render.js"> </script>
    <title> RF Deductible</title>
</head>
<body>
<h1>Командировка по РФ, суточные, Deductible</h1>
</br>
<h2>Рассчет суточных: </h2><br/>Суточные (дополнительные расходы, связанные с пребыванием вне постоянного места жительства)<br/>
- возмещаются за каждый день командировки, включая выходные и нерабочие  праздничные  дни, а также за дни нахождения в пути, в том числе за  время вынужденной остановки в пути;<br/>
- размер суточных устанавливается Приказом по Компании (приказ о суточных) - 500 руб. в сутки; Для командировки на 1 день размер суточных - 250 руб.<br/>
<h3>GL account 511420</h3>
Размер суточных составляет 500 руб. в сутки; для командировки на 1 день 250 руб.
<h3>Введите количество дней к командировке</h3>
<div class="block" id="cal">
    <input id="text" type="text" name="text" size="20" />
    <button id="ok" value="ok" name="ok" type="submit">OK</button>
</div>
<div id="result">
    <br/>
    <h3>Суточные по авансовому отчету составляют:</h3>
    <h2><span class="place1"></span></h2>
</div>
<div id="button">
    <br/>
    <button id="choose1" value="choose1" name="choose1">Choose expense</button>
</div>



<div id="tipeVer" ></div>

<br/>
<div id="tickets" class="hidden block"></div>
<div id="accomodation" class="hidden block"></div>
<div id="clone1"></div>
<a href="#" class="test">Test</a>
<div id="clone2"></div>

<script type="text/javascript">
    $(function () {
    $("#button").hide();
    $("#result").hide();
    $("#cal").ForceNumericOnly();

        $("#cal").keyup(function(event) {
        if (event.keyCode == 13 || event.keyCode == 10) {
            $("#text").submit();
            var text = $("#text").val() ;
            if(text == 1){
                $("#result").show();
                $("#button").show();
                $("#result span.place1").text("Налоговый код - LO   "+ "  ;  "+ "сумма суточных -" +" 250   " + "PIT");
            } else if(text >= 2){
                $("#result").show();
                $("#button").show();
                $("#result span.place1").text("Налоговый код - P0" +"  ; " + "сумма суточных -" +" 500" * text);
            } else {
                alert("Please select the number of days!");
            }
            return false;
            }
    });
        $("#ok").click(function(){
          $(this).attr("disabled", "disabled");
            var text = $("#text").val() ;
            if(text == 1){
                $("#result").show();
                $("#button").show();
                $("#result span.place1").text("Налоговый код - LO" + "  ;  " + "сумма суточных -" +" 250   " + "PIT");
            } else if(text >= 2){
                $("#result").show();
                $("#button").show();
                $("#result span.place1").text("Налоговый код - P0"+ "  ; " + "сумма суточных -" +" 500" * text);
            } else {
                alert("Please select the number of days!");
            }
        });

        $("#choose1").click(function(){
          $(this).attr("disabled", "disabled");
          ///вот тут мы показываем выбиралку выкидуху
          renderCheckboxSection($("div#tipeVer"));
        });

    $("div.hidden").hide();

//    var handle_6 = Anna.FormRender.renderCheckboxSection($("div#accomodation"), Anna.Forms.Data.form9);

    var selectionResults = {
      "1"  : [],
      "2"  : [],
      "3"  : []
    };

    var renderCheckboxSection = function(rootContainer) {
      var handle_5_container = $("<div class='block'></div>");
      rootContainer.append(handle_5_container);

      //вот тут просим выкидуху создаться
      var handle_select = Anna.FormRender.renderSelectControl(handle_5_container, Anna.Forms.Data.checkboxData1);
      handle_select.nextClick(function () {
        if (handle_select() === "1") {
            handle_select.setDisabled();
          renderSelect5(selectionResults["1"], rootContainer);
        }
        if (handle_select() === "2") {
            handle_select.setDisabled();
            renderSelect6(selectionResults["2"], rootContainer);
        }
        if (handle_select() === "3") {
            handle_select.setDisabled();
            renderSelect7(selectionResults["3"], rootContainer);
        }
        return false;
      })
    };

    var renderSelect5 = function(resultsArray, rootContainer) {
      var handle_checkbox_container = $("<div class='block'></div>");
      rootContainer.append(handle_checkbox_container);
        handle_checkbox_container.append("Необходимо подобрать все документы, приложенные к авансовому отчету, относящиеся к билетам. Документы, подтверждающие проезд ж/д транспортом: ж/д билет либо электронный билет. </br><p> Документы, подтверждающие авиаперелет:</p> - электронный билет/счет от агентства;</br> - посадочный талон.</br>Информация (дата, время, рейс, номер электронного билета, имя пассажира) в посадочном талоне должна соответствовать данным в электронном билете.</br> Дата фактического прибытия в место командирования/выбытия из него может иметь расхождение в один день с датой по приказу, когда сотрудник выезжает вечером до 24.00, а прибывает на следующий день.</br> Покупка двух билетов в одну сторону: стоимость одного билета отражается как deductible, остальные билеты- non-deductible, возмещаемый НДФЛ (*PIT). <h3>Все расходы отражаются на GL account 511410</h3>");
        //вот тут просим форму созаться
      var handle_5 = Anna.FormRender.renderCheckboxSection(handle_checkbox_container, Anna.Forms.Data.form7);
      handle_5.nextClick(function () {
        //выключаем вообще все контролы на handle_5
        handle_5.setDisabled();
        ///добавляем в массив результатов значения, выбранные в чекбоксе
        resultsArray.push(handle_5());
        ///на дальше по циклу
        renderCheckboxSection(rootContainer);
      });
    };
        var renderSelect6 = function(resultsArray, rootContainer) {
            var handle_checkbox_container = $("<div class='block'></div>");
            rootContainer.append(handle_checkbox_container);
            handle_checkbox_container.append("<h3>Все расходы на проживание относятся на GL account 511414.</h3> <p>Документы, подтверждающие расходы:</p> - кассовый чек, счет гостиницы, акт, счет</br> - фактура, приходный ордер, квитанция об оплате на бланке строгой отчетности.</br> Счет должен содержать в себе расшифровку затрат (см. пример).</br> В случае, если в стоимость проживания включен завтрак и он не выделен отдельной строчкой в счете, сотруднику необходимо выяснить цену завтрака и указать ее в счете (можно от руки) и заверить штампом гостиницы.");

            var handle_6 = Anna.FormRender.renderCheckboxSection(handle_checkbox_container, Anna.Forms.Data.form9);
            handle_6.nextClick(function () {
                handle_6.setDisabled();
                resultsArray.push(handle_6());
                renderCheckboxSection(rootContainer);
            });
        };
        var renderSelect7 = function(resultsArray, rootContainer) {
            var handle_checkbox_container = $("<div class='block'></div>");
            rootContainer.append(handle_checkbox_container);
            handle_checkbox_container.append('<p>Трансфер</p> - такси по городу от места проживания до места выбытия (аэропорт/вокзал) и обратно или от места прибытия (аэропорт/вокзал) к месту проживания (гостиница) / месту командирования (офис) и обратно в даты командировки. <h3>GL account 511420</h3> <p>Документ должен содержать следующие реквизиты для принятия расхода как deductible:</p> 1. Квитанция должна включать:</br> а) наименование ("Квитанция на оплату пользования легковым такси, серия, номер"), серия и номер квитанции;</br> б) наименование фрахтовщика (наименование, адрес, номер телефона и ИНН);</br> в) дата выдачи квитанции (число, месяц и год оформления);</br> г) стоимость пользования легковым такси (цифрами и прописью);</br> д) фамилия, имя, отчество и подпись лица, уполномоченного на проведение расчетов.');


            var handle_7 = Anna.FormRender.renderCheckboxSection(handle_checkbox_container, Anna.Forms.Data.form10);
            handle_7.nextClick(function () {
                handle_7.setDisabled();
                resultsArray.push(handle_7());
                renderCheckboxSection(rootContainer);
            });
        };

    $("a.test").click(function () {
        $("#clone2").text(JSON.stringify(
                {
                    all : selectionResults
                }
        ));
        return false;
    });

    });

</script>

</body>
</html>