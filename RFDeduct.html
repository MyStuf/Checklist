<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <script type="text/javascript" src="jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="NumberOnly.js"></script>
    <style type="text/css"> @import "css/style.css"; </style>
    <script type="text/javascript" src="tests/Data_list.js"> </script>
    <script type="text/javascript" src="tests/Data_render.js"> </script>
    <title> RF Deductible</title>
</head>
<body>
<h1>Командировка по РФ, суточные, Deductible</h1>
<h3>Этап 1.
Суточные </h3><br/>(дополнительные расходы, связанные с пребыванием вне постоянного места жительства)<br/>
- возмещаются за каждый день командировки, включая выходные и нерабочие  праздничные  дни, а также за дни нахождения в пути, в том числе за  время вынужденной остановки в пути;<br/>
- размер суточных устанавливается Приказом по Компании (приказ о суточных) - 500 руб. в сутки; Для командировки на 1 день размер суточных - 250 руб.<br/>
<h3>GL account 511420</h3>
Размер суточных составляет 500 руб. в сутки; для командировки на 1 день 250 руб.
<h3>Введите количество дней к командировке</h3>
<div class="block" id="cal">
    <input id="text" type="text" name="text" size="20" />
    <button id="ok" value="ok" name="ok" type="submit">OK</button>
</div>
<div id="result">
    <br/>
    <h3>Суточные по авансовому отчету составляют:</h3>
    <h2><span class="place1"></span></h2>
</div>
<div id="button">
    <br/>
    <button id="choose1" value="choose1" name="choose1">Choose expense</button>
</div>

<a href="#" class="test">Test</a>

<div id="tipeVer" ></div>

<br/>
<div id="tickets" class="hidden block"></div>
<div id="accomodation" class="hidden block"></div>
<div id="clone1"></div>

<script type="text/javascript">
    $(function () {
    $("#button").hide();
    $("#result").hide();
    $("#cal").ForceNumericOnly();

     /// это работать не будет. Ты слушаешь кнопку на !всем! документе, а нужно это делать только на
     /// определенном элементе. Вместо document нужно написать что-то по проще
        $(document).keyup(function(event) {
        if (event.keyCode == 13 || event.keyCode == 10) {
            $("#text").submit();
            var text = $("#text").val() ;
            if(text == 1){
                $("#result").show();
                $("#button").show();
                $("#result span.place1").text("Налоговый код - LO   " + "250   " + "PIT");
            } else if(text >= 2){
                $("#result").show();
                $("#button").show();
                $("#result span.place1").text("Налоговый код - P0" + "сумма суточных -" +"500" * text);
            } else {
                alert("Please select the number of days!");
            }
            return false;
            }
    });
        $("#ok").click(function(){
          $(this).attr("disabled", "disabled");
            var text = $("#text").val() ;
            if(text == 1){
                $("#result").show();
                $("#button").show();
                $("#result span.place1").text("Налоговый код - LO   " + "250   " + "PIT");
            } else if(text >= 2){
                $("#result").show();
                $("#button").show();
                $("#result span.place1").text("Налоговый код - P0" + "сумма суточных -" +"500" * text);
            } else {
                alert("Please select the number of days!");
            }
        });

        $("#choose1").click(function(){
          $(this).attr("disabled", "disabled");
          ///вот тут мы показываем выбиралку выкидуху
          renderCheckboxSection($("div#tipeVer"));
        });

    $("div.hidden").hide();

    var handle_6 = Anna.FormRender.renderCheckboxSection($("div#accomodation"), Anna.Forms.Data.form9);

    //вот тут будем хранить результаты
    var selectionResults = {
       /// по каждому варианты будем хранить массив результатов
      "1"  : [],
      "2"  : [],
      "3"  : []
    };

    var renderCheckboxSection = function(rootContainer) {
      var handle_5_container = $("<div class='block'></div>");
      rootContainer.append(handle_5_container);

      //вот тут просим выкидуху создаться
      var handle_select = Anna.FormRender.renderSelectControl(handle_5_container, Anna.Forms.Data.checkboxData1);
      handle_select.nextClick(function () {
        if (handle_select() === "1") {
          //выключаем вообще все контролы
          handle_select.setDisabled();
          /// если выбрали первый вариант - создаем рядом форму для первого варианта
          renderSelect5(selectionResults["1"], rootContainer);
        } else {
          alert("Not implemented! Choose option!!")
        }
        return false;
      })
    };

    var renderSelect5 = function(resultsArray, rootContainer) {
      var handle_checkbox_container = $("<div class='block'></div>");
      rootContainer.append(handle_checkbox_container);

      //вот тут просим форму созаться
      var handle_5 = Anna.FormRender.renderCheckboxSection(handle_checkbox_container, Anna.Forms.Data.form7);
      handle_5.nextClick(function () {
        //выключаем вообще все контролы на handle_5
        handle_5.setDisabled();
        ///добавляем в массив результатов значения, выбранные в чекбоксе
        resultsArray.push(handle_5());
        ///на дальше по циклу
        renderCheckboxSection(rootContainer);
      });
    };

    $("a.test").click(function () {
        alert(JSON.stringify(
                {
                    all : selectionResults
                }
        ));
        return false;
    });

    });

</script>

</body>
</html>