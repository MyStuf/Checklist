<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <script type="text/javascript" src="jquery-1.10.2.min.js"></script>
    <style type="text/css"> @import "css/style.css"; </style>
    <script type="text/javascript" src="tests/Data_list.js"></script>
    <script type="text/javascript" src="tests/Data_render.js"></script>
    <title>RF</title>
</head>
<body>

<h1>РФ</h1>

<div class="block">
    <h3><label for="target">Цель командировки:</label></h3>
    <!-- можно сделать 3 кнопки - так будет удобнне -->
    <select id="target">
        <option value=""></option>
        <option value="1">Участие в производственном совещании</option>
        <option value="2">Участие в конференции</option>
        <option value="3">Участие в семинаре</option>
    </select>
    <button id="targetButton" disabled="disabled">Select</button>
</div>

<div id="target1Block" class="hidden block">
    <h3>Условия, которые должны быть соблюдены:</h3>
    <div id="checkTarget1"></div>
</div>

<div id="target2Block" class="hidden block">
    <h3>Командировочные документы:</h3>
    <h3>Приказ - это .......</h3>
    <h3>Условия:</h3>
    <div id="checkTarget2"></div>
</div>

<div id="target02Block" class="hidden block">
    <h3>Командировочное удостоверение - это .......</h3>
    <h3>Условия:</h3>
    <div id="checkTarget02"></div>
</div>

<div id="targetDecisionBlock" class="hidden block">
    <h3>Выберете решение:</h3>
    <button id="deduct" value="deduct" name="deduct">Deductible</button>
    <button id="non-deduct" value="non-deduct" name="non-deduct">Non-deductible</button>
</div>

<div id="targetExpensesMode" class="hidden block">
    <h3 >Каким образом сотрудник отчитывается:</h3>
    <button id="per">Per Diem</button>
    <button id="fakt">Expenses</button>
</div>

<br/>
<br/>
<br/>
<!--
 потеренный закрывающий </div>
 похоже чтото не то со вложенностью элементов.
 стоит это проверить!
 -->
<a href="#" class="test">Показать выбраные значения</a>

<script type="text/javascript">
    ///тут мы радостно забыли $(function() { ... в итоге половина их всего этого просто не будет работать.
    $(function () {
        ///одним махом прячем все лишнее
        $("div.hidden").hide();

        $("#target").change(function() {
            if ($(this).val() === "") {
                $("#targetButton").attr("disabled", "disabled");
            } else {
                $("#targetButton").removeAttr("disabled");
            }
        });

        //вот тут чтото уж слижком все сложно написано....
        $("#targetButton").click(function () {
            var target = $("#target");
            if (target.val() === "1") {
                $("#target1Block").show();
                $(this).prop('disabled', 'disabled');
                target.prop('disabled', 'disabled');
            } else {
                alert("Not implemented! Choose option!!")
            }
            return false;
        });

        $("#deduct").click(function () {
            $("#targetExpensesMode").show();
        });

        $("#non-deduct").click(function () {
            alert("sorry this page under construction!!");
        });

        $("fakt").click(function () {
            alert("sorry this page under construction!!");
        });

        $("#per").click(function () {
            location.href = "RFDeduct.html"
        });

        $("#fact").click(function () {
            alert("sorry this page under construction!!");
        });

        var handle_1 = Anna.FormRender.renderCheckboxSection($("div#checkTarget1"), Anna.Forms.Data.form3);
        var handle_2 = Anna.FormRender.renderCheckboxSection($("div#checkTarget2"), Anna.Forms.Data.form4);
        var handle_3 = Anna.FormRender.renderCheckboxSection($("div#checkTarget02"), Anna.Forms.Data.form5);

        handle_1.nextClick(function () {
            $("#target2Block").show();
        });

        handle_2.nextClick(function () {
            $("#target02Block").show();
        });

        handle_3.nextClick(function () {
            $("#targetDecisionBlock").show();
        });

        ///обработчик клика по ссылке нужно регистрировать _1_ раз,
        ///иначе он тебе замучает сообщениями
        $("a.test").click(function () {
            alert(JSON.stringify(
                    ///сложим данные по формам
                    {
                        form_1: handle_1(),
                        form_2: handle_2(),
                        form_3: handle_3()
                    }
            ));
            return false;
        });
    });

</script>
</body>

</html>
